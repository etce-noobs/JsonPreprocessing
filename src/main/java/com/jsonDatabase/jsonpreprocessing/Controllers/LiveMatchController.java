package com.jsonDatabase.jsonpreprocessing.Controllers;

import com.jsonDatabase.jsonpreprocessing.Model.LiveMatch;
import com.jsonDatabase.jsonpreprocessing.Model.Players;
import com.jsonDatabase.jsonpreprocessing.Model.ResponseClass;
import com.jsonDatabase.jsonpreprocessing.Repositories.LiveMatchRepository;
import com.jsonDatabase.jsonpreprocessing.Repositories.mongoGameRepositories;
import com.jsonDatabase.jsonpreprocessing.Services.LiveMatchService;
import org.json.simple.parser.ParseException;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RestController
public class LiveMatchController {
    @Autowired
    LiveMatchRepository liveMatchRepository;

    @Autowired
    mongoGameRepositories mongoGameRepositories;

    @Autowired
    LiveMatchService liveMatchService;

    @GetMapping("/match/{id}")
    public ResponseEntity getLiveMatch(@PathVariable("id") String match_id) throws ParseException {
        List<LiveMatch> matchList=liveMatchRepository.findByMatchId(match_id);
        if (matchList.isEmpty()){
            return new ResponseEntity("No such match found!!",HttpStatus.NO_CONTENT);
        }
        LiveMatch match = matchList.get(0);
        Players playersInTheMatch=liveMatchService.getPlayers(match);
        ResponseClass responseClass=ResponseClass
                .builder()
                .liveMatch(match)
                .players(playersInTheMatch)
                .build();
        return new ResponseEntity(responseClass
                ,HttpStatus.OK);

    }
    @GetMapping("/match")
    public ResponseEntity getBriefMatchDetails(){
        return new ResponseEntity(mongoGameRepositories.findAll(),HttpStatus.OK);
    }
}
/*
{"team":"Kolkata Knight Riders","deliveries":[{"0.1":{"bowler":"P Kumar","non_striker":"BB McCullum","extras":{"legbyes":1},"batsman":"SC Ganguly","runs":{"total":1,"extras":1,"batsman":0}}},{"0.2":{"bowler":"P Kumar","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"0.3":{"bowler":"P Kumar","non_striker":"SC Ganguly","extras":{"wides":1},"batsman":"BB McCullum","runs":{"total":1,"extras":1,"batsman":0}}},{"0.4":{"bowler":"P Kumar","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"0.5":{"bowler":"P Kumar","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"0.6":{"bowler":"P Kumar","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"0.7":{"bowler":"P Kumar","non_striker":"SC Ganguly","extras":{"legbyes":1},"batsman":"BB McCullum","runs":{"total":1,"extras":1,"batsman":0}}},{"1.1":{"bowler":"Z Khan","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"1.2":{"bowler":"Z Khan","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":4,"extras":0,"batsman":4}}},{"1.3":{"bowler":"Z Khan","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":4,"extras":0,"batsman":4}}},{"1.4":{"bowler":"Z Khan","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"1.5":{"bowler":"Z Khan","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":4,"extras":0,"batsman":4}}},{"1.6":{"bowler":"Z Khan","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"2.1":{"bowler":"P Kumar","non_striker":"BB McCullum","batsman":"SC Ganguly","runs":{"total":0,"extras":0,"batsman":0}}},{"2.2":{"bowler":"P Kumar","non_striker":"BB McCullum","batsman":"SC Ganguly","runs":{"total":0,"extras":0,"batsman":0}}},{"2.3":{"bowler":"P Kumar","non_striker":"BB McCullum","extras":{"legbyes":1},"batsman":"SC Ganguly","runs":{"total":1,"extras":1,"batsman":0}}},{"2.4":{"bowler":"P Kumar","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":4,"extras":0,"batsman":4}}},{"2.5":{"bowler":"P Kumar","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"2.6":{"bowler":"P Kumar","non_striker":"BB McCullum","batsman":"SC Ganguly","runs":{"total":0,"extras":0,"batsman":0}}},{"3.1":{"bowler":"AA Noffke","non_striker":"SC Ganguly","extras":{"wides":5},"batsman":"BB McCullum","runs":{"total":5,"extras":5,"batsman":0}}},{"3.2":{"bowler":"AA Noffke","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"3.3":{"bowler":"AA Noffke","non_striker":"SC Ganguly","extras":{"legbyes":1},"batsman":"BB McCullum","runs":{"total":1,"extras":1,"batsman":0}}},{"3.4":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"SC Ganguly","runs":{"total":4,"extras":0,"batsman":4}}},{"3.5":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"SC Ganguly","runs":{"total":0,"extras":0,"batsman":0}}},{"3.6":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"SC Ganguly","runs":{"total":1,"extras":0,"batsman":1}}},{"3.7":{"bowler":"AA Noffke","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"4.1":{"bowler":"P Kumar","non_striker":"BB McCullum","batsman":"SC Ganguly","runs":{"total":4,"extras":0,"batsman":4}}},{"4.2":{"bowler":"P Kumar","non_striker":"BB McCullum","batsman":"SC Ganguly","runs":{"total":1,"extras":0,"batsman":1}}},{"4.3":{"bowler":"P Kumar","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":4,"extras":0,"batsman":4}}},{"4.4":{"bowler":"P Kumar","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"4.5":{"bowler":"P Kumar","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"4.6":{"bowler":"P Kumar","non_striker":"BB McCullum","batsman":"SC Ganguly","runs":{"total":0,"extras":0,"batsman":0}}},{"5.1":{"bowler":"Z Khan","non_striker":"SC Ganguly","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"5.2":{"bowler":"Z Khan","non_striker":"BB McCullum","batsman":"SC Ganguly","runs":{"total":0,"extras":0,"batsman":0},"wicket":{"player_out":"SC Ganguly","kind":"caught","fielders":["JH Kallis"]}}},{"5.3":{"bowler":"Z Khan","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":0,"extras":0,"batsman":0}}},{"5.4":{"bowler":"Z Khan","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":0,"extras":0,"batsman":0}}},{"5.5":{"bowler":"Z Khan","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":0,"extras":0,"batsman":0}}},{"5.6":{"bowler":"Z Khan","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":0,"extras":0,"batsman":0}}},{"6.1":{"bowler":"AA Noffke","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"6.2":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":1,"extras":0,"batsman":1}}},{"6.3":{"bowler":"AA Noffke","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"6.4":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":2,"extras":0,"batsman":2}}},{"6.5":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":1,"extras":0,"batsman":1}}},{"6.6":{"bowler":"AA Noffke","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"7.1":{"bowler":"Z Khan","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"7.2":{"bowler":"Z Khan","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"7.3":{"bowler":"Z Khan","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":1,"extras":0,"batsman":1}}},{"7.4":{"bowler":"Z Khan","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"7.5":{"bowler":"Z Khan","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":1,"extras":0,"batsman":1}}},{"7.6":{"bowler":"Z Khan","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"8.1":{"bowler":"JH Kallis","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"8.2":{"bowler":"JH Kallis","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"8.3":{"bowler":"JH Kallis","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"8.4":{"bowler":"JH Kallis","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"8.5":{"bowler":"JH Kallis","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":1,"extras":0,"batsman":1}}},{"8.6":{"bowler":"JH Kallis","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":2,"extras":0,"batsman":2}}},{"9.1":{"bowler":"SB Joshi","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":1,"extras":0,"batsman":1}}},{"9.2":{"bowler":"SB Joshi","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"9.3":{"bowler":"SB Joshi","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":1,"extras":0,"batsman":1}}},{"9.4":{"bowler":"SB Joshi","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"9.5":{"bowler":"SB Joshi","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"9.6":{"bowler":"SB Joshi","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"10.1":{"bowler":"JH Kallis","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"10.2":{"bowler":"JH Kallis","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":4,"extras":0,"batsman":4}}},{"10.3":{"bowler":"JH Kallis","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":0,"extras":0,"batsman":0}}},{"10.4":{"bowler":"JH Kallis","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":6,"extras":0,"batsman":6}}},{"10.5":{"bowler":"JH Kallis","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":0,"extras":0,"batsman":0}}},{"10.6":{"bowler":"JH Kallis","non_striker":"BB McCullum","extras":{"byes":4},"batsman":"RT Ponting","runs":{"total":4,"extras":4,"batsman":0}}},{"11.1":{"bowler":"SB Joshi","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"11.2":{"bowler":"SB Joshi","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"11.3":{"bowler":"SB Joshi","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":2,"extras":0,"batsman":2}}},{"11.4":{"bowler":"SB Joshi","non_striker":"RT Ponting","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"11.5":{"bowler":"SB Joshi","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":0,"extras":0,"batsman":0}}},{"11.6":{"bowler":"SB Joshi","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":1,"extras":0,"batsman":1}}},{"12.1":{"bowler":"JH Kallis","non_striker":"BB McCullum","batsman":"RT Ponting","runs":{"total":0,"extras":0,"batsman":0},"wicket":{"player_out":"RT Ponting","kind":"caught","fielders":["P Kumar"]}}},{"12.2":{"bowler":"JH Kallis","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":4,"extras":0,"batsman":4}}},{"12.3":{"bowler":"JH Kallis","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"12.4":{"bowler":"JH Kallis","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":2,"extras":0,"batsman":2}}},{"12.5":{"bowler":"JH Kallis","non_striker":"DJ Hussey","extras":{"wides":1},"batsman":"BB McCullum","runs":{"total":1,"extras":1,"batsman":0}}},{"12.6":{"bowler":"JH Kallis","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":4,"extras":0,"batsman":4}}},{"12.7":{"bowler":"JH Kallis","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"13.1":{"bowler":"SB Joshi","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"13.2":{"bowler":"SB Joshi","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":0,"extras":0,"batsman":0}}},{"13.3":{"bowler":"SB Joshi","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":1,"extras":0,"batsman":1}}},{"13.4":{"bowler":"SB Joshi","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"13.5":{"bowler":"SB Joshi","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":1,"extras":0,"batsman":1}}},{"13.6":{"bowler":"SB Joshi","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":2,"extras":0,"batsman":2}}},{"14.1":{"bowler":"CL White","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":4,"extras":0,"batsman":4}}},{"14.2":{"bowler":"CL White","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":1,"extras":0,"batsman":1}}},{"14.3":{"bowler":"CL White","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"14.4":{"bowler":"CL White","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":4,"extras":0,"batsman":4}}},{"14.5":{"bowler":"CL White","non_striker":"DJ Hussey","extras":{"wides":2},"batsman":"BB McCullum","runs":{"total":2,"extras":2,"batsman":0}}},{"14.6":{"bowler":"CL White","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":1,"extras":0,"batsman":1}}},{"14.7":{"bowler":"CL White","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"15.1":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":0,"extras":0,"batsman":0}}},{"15.2":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":1,"extras":0,"batsman":1}}},{"15.3":{"bowler":"AA Noffke","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":2,"extras":0,"batsman":2}}},{"15.4":{"bowler":"AA Noffke","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"15.5":{"bowler":"AA Noffke","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"15.6":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":0,"extras":0,"batsman":0}}},{"16.1":{"bowler":"Z Khan","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"16.2":{"bowler":"Z Khan","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":2,"extras":0,"batsman":2}}},{"16.3":{"bowler":"Z Khan","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":1,"extras":0,"batsman":1}}},{"16.4":{"bowler":"Z Khan","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"16.5":{"bowler":"Z Khan","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":2,"extras":0,"batsman":2}}},{"16.6":{"bowler":"Z Khan","non_striker":"DJ Hussey","batsman":"BB McCullum","runs":{"total":2,"extras":0,"batsman":2}}},{"17.1":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"DJ Hussey","runs":{"total":0,"extras":0,"batsman":0},"wicket":{"player_out":"DJ Hussey","kind":"caught","fielders":["CL White"]}}},{"17.2":{"bowler":"AA Noffke","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"17.3":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"Mohammad Hafeez","runs":{"total":0,"extras":0,"batsman":0}}},{"17.4":{"bowler":"AA Noffke","non_striker":"BB McCullum","batsman":"Mohammad Hafeez","runs":{"total":1,"extras":0,"batsman":1}}},{"17.5":{"bowler":"AA Noffke","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":4,"extras":0,"batsman":4}}},{"17.6":{"bowler":"AA Noffke","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"18.1":{"bowler":"JH Kallis","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"18.2":{"bowler":"JH Kallis","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"18.3":{"bowler":"JH Kallis","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"18.4":{"bowler":"JH Kallis","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":4,"extras":0,"batsman":4}}},{"18.5":{"bowler":"JH Kallis","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":1,"extras":0,"batsman":1}}},{"18.6":{"bowler":"JH Kallis","non_striker":"BB McCullum","batsman":"Mohammad Hafeez","runs":{"total":4,"extras":0,"batsman":4}}},{"19.1":{"bowler":"P Kumar","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"19.2":{"bowler":"P Kumar","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}},{"19.3":{"bowler":"P Kumar","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":2,"extras":0,"batsman":2}}},{"19.4":{"bowler":"P Kumar","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":0,"extras":0,"batsman":0}}},{"19.5":{"bowler":"P Kumar","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":2,"extras":0,"batsman":2}}},{"19.6":{"bowler":"P Kumar","non_striker":"Mohammad Hafeez","batsman":"BB McCullum","runs":{"total":6,"extras":0,"batsman":6}}}]}

 */
